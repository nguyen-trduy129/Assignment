/*
 * buzzer.c
 *
 *  Created on: Dec 8, 2022
 *      Author: duyvt
 */


#include "buzzer.h"

TIM_HandleTypeDef htim3;

int buzzer_flag =0;

void buzzerRun(){
	switch (buzzer_flag){
	case BUZZER_OFF:
		__HAL_TIM_SetCompare(&htim3,TIM_CHANNEL_1, 0);
		setTimer6(10);
		setTimer7(160);
		break;
	case BUZZER_ON:

		if (timer6_flag == 1){
			__HAL_TIM_SetCompare(&htim3,TIM_CHANNEL_1, 50 - (get_timer4_counter()/100));
			setTimer6(400);
		}

		if (timer7_flag ==1){
			__HAL_TIM_SetCompare(&htim3,TIM_CHANNEL_1, 0);
			setTimer7(400);
		}

//		__HAL_TIM_SetCompare(&htim3,TIM_CHANNEL_1, 25 );
//		HAL_Delay(200);
//		__HAL_TIM_SetCompare(&htim3,TIM_CHANNEL_1, 25 -5);
//		HAL_Delay(200);
//		__HAL_TIM_SetCompare(&htim3,TIM_CHANNEL_1, 25 -10);
//		HAL_Delay(200);
		break;
	default:
		break;
	}
}
